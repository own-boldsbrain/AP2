{
  "version": "1.2.0",
  "domain": "origination-viabilidade",
  "updated_at": "2025-09-21T00:00:00Z",
  "id": "solar_viability.agent",
  "name": "Solar Viability Agent",
  "description": "Agente MCP para pré-sizing fotovoltaico (pvlib + NASA POWER).",
  "type": "executor",
  "mission": "Calcular viabilidade técnica-energética-econômica (pvlib + NASA POWER).",
  "runtime": {
    "type": "python",
    "entrypoint": "domains/origination-viabilidade/apps/viability_service/app/main.py",
    "requires": ["fastapi>=0.115","uvicorn>=0.30","pydantic>=2.7","numpy","pandas","requests","pvlib>=0.10.5","nats-py>=2.6"]
  },
  "capabilities": {
    "a2a_roles": ["executor"],
    "contexts": ["YSH/Origination","YSH/Viability"]
  },
  "tools": [
    {
      "name": "viability.compute",
      "summary": "Executa cadeia pvlib e retorna kWh/ano/PR.",
      "input_schema": {
        "type": "object",
        "required": ["lat","lon"],
        "properties": {
          "lat": {"type":"number"}, "lon": {"type":"number"},
          "tilt_deg": {"type":"number","default":20},
          "azimuth_deg": {"type":"number","default":180},
          "mount_type": {"type":"string","enum":["fixed","single_axis_tracker"],"default":"fixed"},
          "system_loss_fraction":{"type":"number","default":0.14},
          "meteo_source":{"type":"string","enum":["NASA_POWER","CLEARSKY_ONLY"],"default":"NASA_POWER"}
        },
        "additionalProperties": true
      },
      "output_schema": {
        "type": "object",
        "required": ["kwh_year","pr"],
        "properties": {"kwh_year":{"type":"number"}, "pr":{"type":"number"}, "mc_result":{"type":"object"}}
      }
    },
    {
      "name": "tariff.lookup",
      "summary": "Obtém perfil tarifário (delegado ao aneel.tariffs.agent).",
      "input_schema": {
        "type": "object",
        "required": ["uf","distribuidora","classe"],
        "properties": {
          "uf":{"type":"string"}, "distribuidora":{"type":"string"}, "classe":{"type":"string"},
          "modalidade":{"type":"string","enum":["convencional","branca","azul","verde"]}
        }
      },
      "output_schema": {"type":"object","required":["tariff_profile"], "properties": {"tariff_profile":{"type":"object"}}},
      "delegate": "aneel.tariffs.agent"
    },
    {
      "name": "economics.evaluate",
      "summary": "ROI/Payback/TIR a partir de geração e tarifas.",
      "input_schema": {
        "type": "object",
        "required": ["kwh_year","tariff_profile","capex","opex"],
        "properties": {
          "kwh_year":{"type":"number"}, "tariff_profile":{"type":"object"},
          "capex":{"type":"number"}, "opex":{"type":"number"},
          "lifetime_years":{"type":"number","default":25},
          "degradation_pct_year":{"type":"number","default":0.5},
          "discount_rate_pct":{"type":"number","default":10.0}
        }
      },
      "output_schema": {
        "type": "object",
        "required": ["roi_pct","payback_years","tir_pct"],
        "properties": {"roi_pct":{"type":"number"}, "payback_years":{"type":"number"}, "tir_pct":{"type":"number"}, "cashflow":{"type":"array","items":{"type":"number"}}}
      }
    }
  ],
  "events": { "publishes": ["viability.completed.v1"], "consumes": ["viability.requested.v1"] },
  "security": { "pii": false, "allowed_network": ["https://power.larc.nasa.gov/*","https://dadosabertos.aneel.gov.br/*"] }
}
