{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Contract",
  "description": "Schema for a contract artifact, used for storing customer requirements and initial analysis.",
  "type": "object",
  "properties": {
    "contractId": {
      "type": "string",
      "description": "Unique identifier for the contract.",
      "format": "uuid"
    },
    "customerId": {
      "type": "string",
      "description": "Identifier for the customer."
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp of when the contract was created."
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp of the last update."
    },
    "status": {
      "type": "string",
      "enum": [
        "draft",
        "pending_analysis",
        "analysis_complete",
        "closed"
      ],
      "description": "The current status of the contract."
    },
    "requirements": {
      "type": "object",
      "properties": {
        "location": {
          "type": "object",
          "properties": {
            "address": {
              "type": "string"
            },
            "latitude": {
              "type": "number"
            },
            "longitude": {
              "type": "number"
            }
          },
          "required": [
            "latitude",
            "longitude"
          ]
        },
        "energyProfile": {
          "type": "object",
          "properties": {
            "averageMonthlyConsumptionKwh": {
              "type": "number"
            },
            "utilityProvider": {
              "type": "string"
            },
            "tariffClass": {
              "type": "string"
            }
          }
        },
        "objectives": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of customer objectives (e.g., cost reduction, energy independence)."
        }
      },
      "required": [
        "location"
      ]
    },
    "initialAnalysis": {
      "type": "object",
      "description": "Results from the initial analysis by the Investigation swarm."
    },
    "detectionResults": {
      "type": "object",
      "description": "Results from the Detection swarm's analysis."
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata about the contract.",
      "additionalProperties": true
    },
    "swarmContext": {
      "type": "object",
      "description": "Context information for swarm coordination.",
      "properties": {
        "swarmId": {
          "type": "string",
          "description": "Identifier for the swarm handling this contract."
        },
        "traceId": {
          "type": "string",
          "description": "Trace identifier for end-to-end tracking."
        },
        "parentSwarmIds": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Identifiers for parent swarms, if this is a sub-swarm."
        }
      }
    }
  },
  "required": [
    "contractId",
    "customerId",
    "createdAt",
    "status",
    "requirements"
  ]
}